name: Generate Pacman Animation

on:
  schedule:
    - cron: "0 */12 * * *"
  workflow_dispatch:
  push:
    branches: [ main ]

jobs:
  generate:
    runs-on: ubuntu-latest
    permissions:
      contents: write

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Generate Pacman SVG
        run: |
          echo '<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%">
            <style>
              .pacman { animation: eat 1s linear infinite; transform-origin: center; }
              @keyframes eat { 0% { transform: rotate(0deg); } 50% { transform: rotate(-30deg); } }
            </style>
            <circle cx="50" cy="50" r="40" fill="#FFD700" class="pacman"/>
          </svg>' > pacman-contribution-graph.svg
          
          # Создаем темную версию
          sed 's/#FFD700/#FFA500/g' pacman-contribution-graph.svg > pacman-contribution-graph-dark.svg

      - name: Push to output branch
        uses: actions-js/push@v1
        with:
          branch: output
          directory: .
          force: true
          silent: true
